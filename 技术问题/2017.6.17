构造函数 SpriteSheetPainter_player没有用new；
Sprite的位置和尺寸在参数中传递，方便使用
人物精灵的位置在画布中间，尺寸是40,40
制造了蜥蜴怪物，没有添加到sprites
需要一个对象包含一个精灵的所需要的一切信息，不仅仅是截取的信息！
创建真是的monsterData_rea用的是Object.assign()
为何会先执行paintSprites不是添加精灵？
是updateSprites导致的NAN
detailX是Nan;
requestAnimationFrame的回调函数中传入的实参是从页面开始到执行当前帧的时间戳，而不是从1970到现在的时间戳！
在动画只调用一个的情况下，行为对象的属性last是0怎么进入控制流的？
是在循环中，行为对象只有一个，导致对象的复用；
为啥行为对象的数组添加了四个对象？
因为behaviors属性也需要重建，也就是说一个sprite对象，需要三个新的对象来表达行为方面；
函数作用域是在函数定义的时候，而不是调用的时候，getSpritesVelocity中的self。
精灵的位置总是在一起出现，肯定有问题:随机数的取整后没有乘以比例，尴尬；精灵的位置总是在一起出现，肯定有问题:随机数的取整后没有乘以比例，尴尬；
把startAnimate函数中更新速度的时候，把基础速率抽取作为参数；抽取的变量在函数外面；
在旋转角度的时候又遇到了问题：所有的精灵都旋转了一样的角度，但是最起码他旋转了。。。
精灵的velocityY都死哪去了？？？测试后发现：是在行为对象movingBehavior上出现了问题，但是，饿死了，先吃饭吧- -；
I know that，还是太二了，把判断的等于当成了'=',你是猪吗
角度的算法出现问题，把弧度转化为角度看看是怎么回事吧：fuck！居然把正切函数设成velocityX/velocityY...醉了，，肯定是velocityY/velocityX啊-_-
-------------------------------------------怪物精灵静态的已经全部准备好了！，让我们开启动画之门吧！
全部都动，但是感觉很僵硬。。速度太慢了，而且都一样，这是不可能的，把baseVelocity删除，在monstersData_tem上修改，gogogo！
人物绘制不出来了：由于在Sprite构造添加了新的velocity属性，因此所有调用的对象都受到了影响，包括人物,故添加一个velocity属性；
-------------------------------------------怪物精灵已经可以动了，搞人物吧；
人物的话，就不会计算速率，因为是手动档，可以用事件触发；也就是上面添加的velocity属性；
怪物的速率由startAnimate决定，人物的话，由事件决定把，由velocity改变velocityX和velocityY；
方向键失效了，为啥？经过一番检查，发现只有首个addKeyAndListener事件会触发，let`s find why
太傻逼了，for循环里面竟然用了return，最重要的是没有写到控制流里面。。
人物在没有速度的时候，应该保持上一次的旋转角度，故不改变就可以了（就是这么简单）;
存在一个巨大的问题：旋转点的问题，之前全部都不对！都要改**
由于人物的移动是有事件触发的，因此行为对象不一定是常驻的；
人物是腿在上面的。。绘制顺序问题；
把怪物的旋转点以及怪物获取速度所依靠的位置就行了对应；
想让人物在不点击按键的时候不动，但是在每一帧重置速率并不行;先写一个定时器来暂时解决；
由于按键事件不能同时触发两个，因此在按键的时候要进行标记；
用集合的思想修改过后，还是出现了很多额问题:在keyup的时候清除标记，还要清除精灵速度;
我的天，人物的移动终于搞定了。。。原来以为几行就解决，写了几百行
gunfire精灵放在player精灵上行不行？不行
鼠标在和键盘事件进行组合的时候，鼠标基本上看不出来，可能只有一帧的改变，根本看不出来；在一定的时间内让键盘事件废了就行了
加入gunfire精灵后，画面开始疯狂旋转？？why?
问题一，旋转后，没有恢复context；问题二，绘制精灵的cellIndex属性的更新算法死在算数运算符的优先级了-_-,贼尴尬；
fireLine精灵为何看不到？：线只能用stroke方法，而不能用fill方法；
出现了一个惊天bug：人物移动后fireLine精灵也会改变方向，把旋转的方向写死;
又出现一个问题：fireLine精灵的radian的值，肯定自己不会自己重置：每一次都创建新的对象
除了radian属性，用到的位置信息也就跟着动；！！！
-------------------------------------------------------碰撞检测
在game属性中增添shapes属性，在loop中添加shape对象，先检测坦克的碰撞；
对SpriteShape对象的点进行改进，废弃它的move方法，不行，不能废弃，用mtv反弹的时候用来反弹，只修改设置点的方法
人物精灵的旋转角度为何是undefind？？：因为人物和怪物的弧度属性是在update之后才获取到的；
！！左上角的点的旋转坐标测试成功！，下一步测试其他三个！其他的三个点的算法有问题！一个一个写！：用向量！
。。。太不容易，一个函数写了一天了，算了最起码三种算法了 - -
第一步：检测怪物和坦克的碰撞！
在怪物精灵添加到game对象的就顺手添加要检测的图形对象，在创建的时候就不调用setPolygonPoints方法了，因为这个时候怪物精灵没有弧度信息，而且也并不可能会碰撞啊。。。  -_-
在polygon对象上添加名字的属性，用来区别主动检测者；
在endAnimate方法上获取并更新这一帧的所有怪物的图形点；并且开始检测碰撞，因为刚开始怪物精灵图形并没有点，需要旋转弧度和位置来确定；
从Polygon上继承的points属性也是共享的？
明天再说吧。。一个tank的碰撞检测都没有完成。。
先检测更新是否有问题，再检测检测是否有问题
更新的时候，points属性会不断增加，需要每一次都清除，在清楚之后，感觉更新没有问题了
先检查tank的坐标把,坐标没有问题，但是投影轴很明显是有问题的，四个都差不多的方向 - -how is that possible?
卧槽！the asshole is edge？kidding me？居然这个方法写错了。。
顺手再用fill方法测试检测碰撞点的准确性！：在endAnimate上填充,精灵的碰撞检测的点的算法又出现了问题，主要是人物精灵的形状是正方形，而怪物精灵的形状是不规则的矩形。
精灵绘制的width和height属性到底有什么用呢？1也可以完全显示
开始弄fireLIne的碰撞检测;第一次检测失败、、先检查更新
检查是在startAnimate上进行的，但是fireLine是在点击鼠标的时候才有的，因此要加入clicking判断，正好也就是在这个时期进行的碰撞检测.w
我去，fireLine第一个点的坐标是866？？？？黑人问号length（计算半径）算法写错了- -
这个图形是点击的时候加入的，所以还挺复杂了，想办法先更新再检测
这什么鬼啊，朝天开一枪，都被击中了？？？frieLine的算法还是有问题;;卧槽，我忘了，旋转的角度是在精灵的painter对象上 - -


//fireLine碰撞事件
接下来让中枪的精灵都进行死亡动画，并且清除sprites以及shapes
part one 进行死亡动画：需要添加一个新的绘制器,新的行为对象，都是一个行不行？
healthPoint为NaN？人物血100，gunfire血0，fireLine血0
1.怪物不能重复的进行检测：被击中的怪物精灵加一个hitted属性,每一枪的时候刷新
遇到一个问题：怪物本来现在应该是一直死的。。但是没有
2.怪物不能一直死
在update上删除精灵，以及相应的图形

bug：方向键失灵，同时精灵不能碰撞
总有一个怪物检测不到碰撞
lizard被击中了，但是shapes属性里面spider消失了？惊天BUG：只是隔了两行的代码，this.sprites[i]代表的对象会不一样，最离谱的是：还不一定会不一样，我的天啊、、：splice之后，这个数组的成员更新，用同一个i就取到了不同的对象，而
方向键的暂时还没有找出来bug：
解决一次射击和多次射击的重复问题:click的时候，refresh怪物的hitted属性；

boss怪物，不移动？：获取速度的函数中没有加入相应的判断

//下一个，人物的碰撞，也就是人物的死亡；有一个问题就是：这些怪物的中心会向人物的中心跑去，这肯定不行啊，把判断怪物速度的函数重写一下,重写了一下是可以了，但是呢，怪物在指定的位置不能去除行为数组，因为怪物要跟着人动的。用stick属性，但是还没有开启
//怪物搞定了，该让让人物死亡了。。
人物为何不动？？还TM缩小了。。
if(sprite_player.animating===true){
      sprite_player.behaviors=[runInPlaceBehavior,movingBehavior]
   }else{
  sprite_player.behaviors=[];
}
每一帧的时候，都会执行这行代码，那么就会被重写，要阻止这个行为，两个小时了。。
两个问题：一直死和死的位置偏差
一直死：直接暂停；bingo
位置偏差：试试写一个控制流或者是重写一个（better）绘制器；


重新整理思路：
1.主循环：
一：tick（时间）
二：清屏
三：开始动画
四：精灵下层
五：更新精灵
六：绘制精灵
七：精灵上层
八：结束动画
2.精灵对象
根据截取信息和精灵位置信息：painter
更新截取信息和根据精灵的速度更新，精灵位置以及精灵的旋转角度：behaviors
3.人物精灵
开场设置位置信息，截取信息等信息，但是不设置行为对象去更新角度，位置，截取信息：因为人物只在事件的时候才触发。
事件的时候：让人物根据一个人物的基准速度和按键来获取一个速度，同时开启两个行为对象。
人物的血量为0的时候，更换一个截取信息的绘制器对象，并且设置行为对象为只更新截取信息
截取信息为最后一张的时候，游戏结束；
4.怪物精灵
开场随机设置位置信息，截取信息，两个行为对象
每一帧都根据怪物精灵的位置信息和目标（修正）位置信息和基准速度来获取一个速度；
在怪物精灵到达目标地点后，更新一个截取信息的绘制器对象，并且设置行为对象为更新截取信息；
在截取信息为最后一张的时候，清除精灵和图形；
5.人物精灵根据事件获取速度的算法的调整
在点击按键的时候有卡顿感觉，是因为在事件触发的时候才进行精灵速度的调整，这个速度获取应该和怪物的速度一样，在每一帧的时候确定；
问题：1.速度大小问题:搞定
2.1开火之后的gunFire bug:搞定
2.2fireLine:这个精灵的速度不应该在moving行为对象上进行 ，而是在startAnimating上进行；

3.怪物击中的后退效果
!算法完全不对，人物运动的是由速度决定的，但是身体部分是全程由鼠标位置决定的:决定废弃！:搞定

4.怪物坦克的mtv：
出现了怪物无法改变位置的情况:搞定
出现了巨大改变的情况，原因：图形点和精灵图的left，top之间的差距

在设置人物的散弹枪的时候：出现了非常炫酷的效果，但是很无语。:突然想起来书上面的填充的规则；
散弹枪出来了，但是没有碰撞检测;碰撞测试的修复！数组的splice方法如果start参数是negative，那么会加上数组的长度；而不是不操作;由于linePainter_fireCircle需要储存一些数据，因此需要重复创建；
问题来了，大火球怎么判断碰撞边界- -;我的天。。这个大火球里面的坑简直是月球表面- -
大火球和怪物的碰撞检测用多边形检测！！
在大火球的检测之前根据经验，我需要一杯水来压压惊；
1.果然不出所料，一点就出问题，这次是一个单词的大小写搞错了，用成构造函数了；
2.Circle对象中的方法中，有一个构造函数Projection，没用new；现在最起码大火球能动了。。但是怪物还是无敌的（微笑脸）；
3.nice！火球碰撞了完成了，再添加事件之前，先解决连续碰撞的问题，和往常的一样；&&shape.sprite.hitted_everyClick===false添加一个这个判断条件就可以！
4.我大火球，一球致命，不关心血量；
5.完善火球的推出时间；由于这个武器太牛逼了，所以在开一枪后就会重置；
设置，人物和tank的碰撞检测，还出现了boss怪物的检测偏移问题，估计是不小心碰到哪了；
人物和tank的碰撞需要在beforeStart()里面写入人物的检测图形；
人物和tank的碰撞出现了乾坤大挪移的情况:检查了一下，mtv应该没有什么问题，是不是人物的移动速度太快了;未知错误、、
换一种算法，碰撞了就把行为对象去除了；
1.人走到tank上，就死了？？？怎么回事呢人物stick后，算法开始见煞牌人物的血量
2.人只要移动，stick就是false，什么鬼？？：原因是人物的速度的获取是在判断检测之后的。。
3.人物会想粘在tank上一样，怎么办？先更新下信息再判断；
4.不能先更新，而是只用信息，而不改变信息，否则人物就会动、、、
今天的目标：让游戏跑起来：
part one 武器的切换；bingo
想到一个问题：疯狂点击的问题；这肯定是不行的
嗯？本想解决连续点击怪物重复死的问题，但是竟然自己解决了，这是为什么？：是自己点击的时间间隔有问题，问题还是存在的- -
但是实际上挺好的，多了一个鞭尸的功能；但是无限点击的必须解决，这个不能忍！
写程序：最重要的一点是，一个好听的歌曲！！！
part two canvas边界的绘制
先检测哪些程序用到了canvas的尺寸，由于canvas的坐标系是左上角，所以在右侧进行扩展；
开始扩展！怪物会跳出游戏区域，很尴尬，所以不能用背景颜色，直接绘制吧。。:还是不行，因为精灵是在填充之后进行的，所以，这部分的填充，是在精灵的绘制之后；bingo！
突然想起来：方向键不能老是那几个键，很不方便，调整为W。A.S.D:bingo!
正式开始右侧填充栏的绘制；bingo!
先把最主要的更新抽取成为一个函数；bingo!
还未设定怪物的刷新,所以就先不写更新了，先测试其他三个的执行情况：卧槽，全部都黑了？！什么鬼！:****所有的信息都是用参数的形式的传进去的，改变这个值，并不能影响原先的变量，故采用一个对象来储存这些信息，到时候直接修改这些信息就可以了；
!!直接揭盖要给对象的（！！值！！）也是木有用的，并不能改变原来对象的属性值，需要改变对象的属性，而他不是值！！！！！！
虽然经历了千辛万苦，但是最后：bingo！！！！！哈哈
休息一下，进行第三part！！
part three 怪物的定时刷新；
我来啦，怪物的定时刷新！！！！！
添加怪物在精灵方面或许没有什么问题，但是在碰撞图形的方面就会出现了一些问题，因为精灵图形的添加是依靠数组中的怪物精灵来添加的，这肯定是不行的。
``
为此重写了addSprites_monster，添加了返回值，返回添加的怪物精灵；
1.怪物精灵添加成功，但是运行出了bug，应该是准备检测方向的问题吧，毕竟这些精灵都没有检测点就进行检测，今天就到这把先，明天继续！
明天的目标：
1.把游戏流程写出来，
2.还有很多的bug需要完善，比如说：1.鼠标连点，2.boos的偏移，3.有时候的碰撞的失灵问题
3.进场退场的页面明天也需要写出来
我来啦啦啦!:
part one:把游戏流程写出来
昨天的游戏流程是由定时器刷新出来的，这个昨天晚上想了一下，感觉并不行， 因为如果游戏突然暂停了怎么办呢？所以决定采用基于游戏时间的游戏流程刷新，gogogo！
由于要写入游戏时间的记录。。有点尴尬，忘记把毫秒转为秒数了。。再写一个把毫秒转为分秒的函数就行了，应该不可能有人能玩超过一个小时吧，哈哈：bingo！但是发现了一个问题：火球术不能用之后，居然还能用，kidding me？还有一个问题，再说释放火球术之后五秒，才变为不可用，这显然不行啊，这五秒里面还可以释放啊，应该是立刻不能用啊！:bingo!
但是在测试中又出现了一个问题，就是每次击杀都会刷新火球术？什么鬼？我不是写了是杀二十个才刷新吗？？？:bingo!
那么我们就正式地来写游戏的流程吧！我的大刀早已饥渴难耐！
第一步：重写beforeGame函数：bingo
第二步：决定采用panel里面的游戏时间来进行游戏循环，但是不行，还是采用了game对象的gameTime，因为panel转化为了分秒，比较大小的话比较麻烦，两个基本上没有区别；把函数middleGame写在endAnimate里面，因为后面就会更新检测的内容了，希望不要报错啊！！：十秒钟之后，整个canvas界面呈现出了爆炸局面，每一帧都添加了一大堆怪物。。。赶紧看看是哪出了问题、、、、:bingo!改变属性，而不是修改值；
问题：
1.在大火球结束后，出现了一个bug；
Uncaught TypeError: Cannot read property 'painter' of null
    at Game.updateCircleShapeXandY_fireCircle (game-engine.js:1006)
    at Game.endAnimate (game-engine.js:327)
    at Game.animate (game-engine.js:138)
    at game-engine.js:148
这个bug不应该啊，我前面还加了一个判断，把loop去掉后看看火球还有没有问题；说明在火球结束的时候，图形还在，但是精灵成功删除了；
好像我在火球这个期间，如果用其他武器的话，就会出问题对不对？:是的，我惊呆了，如果在这五秒内用其他武器杀死怪物的话，会创建出两个火球图形对象，这又是什么鬼？：卧槽。。添加图形对象的看控制流写的太垃圾了，才导致这种局面的发生，赶紧重写：bingo！
2.进行不合理，随着时间的增加，30秒之后基本上整个屏幕全是怪物了，必须进行控制：
目标是：不能让玩家在前一分半钟以前，那么容易就屎了。
调整为半分钟开始增加zombie，lizard各一个，一分钟再增加一个spider:bingo!
顺手发现了一个bug：人物的血量会变成负数，这就比较尴尬了。。。:bingo！
人物血量数值的更新需要进行整数处理:bingo!
游戏的目标是坚持五分钟。这个嘛。。这几天慢慢完善吧。。逃出荒岛系列、、、，马上做出来了
先搞part three进场退场的页面明天也需要写出来:

1.鼠标连点：bingo
2.boos的偏移：感觉是尺寸问题：bingo
3.有时候的碰撞的失灵问题
4.火球术:bingo!




1.图片的加载
2.游戏流程
3.前后页面的绘制
1.首次bug：Game对象能检测到加载的点击：把game添加到是事件处理程序还是解决不了问题:bingo
2.结束页面不显示？、：bingo!
3.再来一局这个按钮怎么也消失不了这是为啥呢？？：因为调用了game.start();
4.绘制图像出现错误、、原因是。。虽然图像加入了队列，但是，并没加入this.images，因此无法调用：bingo
5.纪念一下，初步能运行了，写一下叙述性的文字:bingo!
6.加载图形,,,什么鬼啊，为啥跟我想象中的完全不一样呢:需要去除0加载的情况，因为会影响后面整个的描边绘制的起点；bingo!
总是不显示最后进度条完全加载后的页面，而是直接进入了游戏，这不行！:引入一个新的变量index_flag:bingo!
7.暂停：bingo！



文字阴影；
音乐:先把音乐和枪搞定吧:bingo!
由于音效播放的时长，调整click的时间间隔调整为500毫秒！,经过考虑，放弃repeal，改用reload代替，因为repeal的声音实在太短了：bingo！
把所有的音效都搞定:bingo！
把武器都设置好，（增加一个，并且排序）：bingo!
惊天bug：暂停后怪物消失是什么鬼？最后了不要给我搞事情啊！:暂停的时候没有问题，但是再次开启的时候，怪物就会消失??
发现精灵并没有消失，而是他们的位置突然飙升至几十万。。是速度的改变吗？：是由于fps的大幅度改变而导致的巨量位移；
gameTime和startTime是date为基础的时间戳，但是lastTime和time是从游戏开始的时间戳，这肯定是差距巨巨巨巨巨大的：bingo
搞事情加一：散弹枪在人物移动后竟然还是会跟着动。。。醉了，竟然还有这种低级bug：bingo
游戏流程；
tankBUG：bingo！


1.发现BUG：暂停和结束后的鼠标点击依然有效果（声音。。）:bingo!
2.连续点击的声音特效问题（必须依次播放？）:bingo!
3.加入书籍图像，美化界面：bingo!
4.页面出现横向滚轮
5.游戏难度调整：bingo！





